name: check-all-seats
on:
  schedule:
    - cron: '*/1 * * * *'   # 每 1 分鐘檢查一次
  workflow_dispatch:         # 允許手動觸發
concurrency:
  group: check-melon-211541
  cancel-in-progress: true

jobs:
  check:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        block: [
          767, 771, 773, 775, 779, 780, 782,
          801, 800, 799, 798,
          796, 683, 794, 685, 793, 688, 792, 690, 791, 692, 790, 694, 788, 696,
          787, 786, 785, 784,
          736, 735, 734, 733, 732, 729, 726, 724, 723, 722, 721, 720, 719, 718, 717, 715, 714, 713, 712, 710
        ]
    steps:
      - name: Check Tickets (block ${{ matrix.block }})
        uses: mooyoul/melon-ticket-actions@v1.1.0
        with:
          product-id: 211541         # 你的 prodId
          schedule-id: [100001, 100002, 100003]        # 你的 scheduleNo
          block-id: ${{ matrix.block }}
          slack-incoming-webhook-url: ${{ secrets.SLACK_WEBHOOK_URL }}
          message: "<@U12345678> 🎫 block ${{ matrix.block }} 有票！"
